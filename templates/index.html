
{% extends "base.html" %}
{% block content %}
  <div class="hero-section">
    <div class="hero-content">
      <h2>Transform Your Landing Pages with AI-Powered Attention Analysis</h2>
      <p>Get professional CRO insights, saliency maps, and optimization recommendations powered by OpenAI Vision</p>
      <div class="hero-actions">
        <a href="/demo" class="btn-secondary">
          <i class="fas fa-eye"></i>
          <span>View Sample Output</span>
        </a>
      </div>
    </div>
  </div>

<div class="main-grid">
  <!-- Analysis Form -->
  <div class="form-card">
    <div class="card-header">
      <div class="card-icon">
        <i class="fas fa-rocket"></i>
      </div>
      <div class="card-title">
        <h3>Start Analysis</h3>
        <p>Enter a URL or upload an image to begin</p>
      </div>
    </div>

    <form id="analyze-form" hx-post="/analyze" hx-target="#results" hx-swap="innerHTML" enctype="multipart/form-data" class="analysis-form">
      
      <!-- URL Input Section -->
      <div class="form-section">
        <div class="section-header">
          <i class="fas fa-link"></i>
          <h4>Landing Page URL</h4>
        </div>
        <div class="input-group">
          <input type="url" name="url" placeholder="https://example.com" class="form-input url-input">
          <div class="input-actions">
            <label class="checkbox-wrapper">
              <input type="checkbox" name="fullpage" value="true" checked>
              <span class="checkmark"></span>
              <span class="checkbox-label">Full-page screenshot</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Analysis Settings -->
      <div class="form-section">
        <div class="section-header">
          <i class="fas fa-cogs"></i>
          <h4>Analysis Settings</h4>
        </div>
        <div class="settings-grid">
          <div class="setting-group">
            <label>Saliency Grid</label>
            <div class="grid-controls">
              <div class="input-pair">
                <input type="number" name="rows" value="12" min="6" max="24" class="form-input small">
                <span class="input-label">Rows</span>
              </div>
              <div class="input-pair">
                <input type="number" name="cols" value="8" min="6" max="24" class="form-input small">
                <span class="input-label">Columns</span>
              </div>
            </div>
          </div>
          
          <div class="setting-group">
            <label>AI Model</label>
            <input type="text" name="model" value="{{ openai_model }}" class="form-input">
          </div>
          
          <div class="setting-group">
            <label>Creativity Level</label>
            <div class="slider-container">
              <input type="range" name="temperature" min="0" max="1" step="0.1" value="0.2" class="slider" id="temperature-slider">
              <div class="slider-labels">
                <span>Focused</span>
                <span id="temperature-value">0.2</span>
                <span>Creative</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- File Upload Section -->
      <div class="form-section">
        <div class="section-header">
          <i class="fas fa-upload"></i>
          <h4>Or Upload Screenshot</h4>
        </div>
        <div class="file-upload-area">
          <input type="file" name="file" accept="image/png,image/jpeg,image/webp" id="file-input" class="file-input">
          <label for="file-input" class="file-upload-label">
            <div class="upload-icon">
              <i class="fas fa-cloud-upload-alt"></i>
            </div>
            <div class="upload-text">
              <span class="upload-title">Choose an image file</span>
              <span class="upload-subtitle">PNG, JPEG, or WebP up to 10MB</span>
            </div>
          </label>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="form-actions">
        <button type="submit" class="btn-primary">
          <i class="fas fa-magic"></i>
          <span>Analyze with AI</span>
        </button>
      </div>
    </form>
  </div>

  <!-- Preview Card -->
  <div class="preview-card">
    <div class="card-header">
      <div class="card-icon">
        <i class="fas fa-eye"></i>
      </div>
      <div class="card-title">
        <h3>Preview</h3>
        <p>Your image will appear here after upload or URL capture</p>
      </div>
    </div>
    
    <div class="preview-content">
      <div class="preview-placeholder">
        <i class="fas fa-image"></i>
        <p>No image selected</p>
      </div>
    </div>
  </div>
</div>

<!-- Results Section -->
<section id="results" class="results-section">
  <!-- HTMX will inject results here -->
</section>

<script>
  // Temperature slider value display
  document.getElementById('temperature-slider').addEventListener('input', function(e) {
    document.getElementById('temperature-value').textContent = e.target.value;
  });

  // File input preview
  document.getElementById('file-input').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const preview = document.querySelector('.preview-content');
        preview.innerHTML = `
          <div class="image-preview">
            <img src="${e.target.result}" alt="Preview" class="preview-image">
            <div class="image-info">
              <span class="file-name">${file.name}</span>
              <span class="file-size">${(file.size / 1024 / 1024).toFixed(2)} MB</span>
            </div>
          </div>
        `;
      };
      reader.readAsDataURL(file);
    }
  });
</script>
{% endblock %}
